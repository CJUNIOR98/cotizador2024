!function(){function e(){var e=document.createElement("div");e.className="loader-container",e.id="loaderContainer",e.style.display="block";var t=document.createElement("div");t.className="loader",t.textContent="Cargando...",e.appendChild(t),document.body.appendChild(e)}function t(){var e=document.getElementById("loaderContainer");e&&e.parentNode.removeChild(e)}$(document).ready((function(){$("body").on("click",".confirmar",(async function(e){e.preventDefault();const t=$(this).attr("href");0!=(await Swal.fire({title:"¿Estás seguro?",showCancelButton:!0,confirmButtonText:"Si, está bien"}).then((e=>e))).isConfirmed?(Swal.fire("¡Confirmado!","Redirigiendo...","success"),setTimeout((()=>{window.location=t}),1500)):console.log("Acción cancelada.")})),$("body").on("click",".delete-bulma-notification",(function(e){$(this).closest(".notification").remove()})),(()=>{"use strict";const e=document.querySelectorAll(".needs-validation");Array.from(e).forEach((e=>{e.addEventListener("submit",(t=>{e.checkValidity()||(t.preventDefault(),t.stopPropagation()),e.classList.add("was-validated")}),!1)}))})(),0!=$(".summernote").length&&$(".summernote").summernote({placeholder:"Escribe en este campo...",tabsize:2,height:300}),function(){if(1==["bs","bs5","bs_lumen","bs_lux","bs_litera","bs_vapor","bs_zephyr"].includes(Bee.css_framework))[].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]')).map((function(e){return new bootstrap.Tooltip(e)}))}(),!1!==Bee.toastr&&(toastr.options={closeButton:!0,debug:!1,newestOnTop:!0,progressBar:!0,positionClass:"toast-top-right",preventDuplicates:!1,onclick:null,showDuration:"300",hideDuration:"1000",timeOut:"5000",extendedTimeOut:"1000",showEasing:"swing",hideEasing:"linear",showMethod:"fadeIn",hideMethod:"fadeOut"})})),document.addEventListener("DOMContentLoaded",(()=>{console.log("////////// Bienvenido a Bee Framework Versión "+Bee.bee_version+" //////////"),console.log("//////////////////// www.joystick.com.mx ////////////////////"),1==Bee?.is_local&&console.log(Bee),async function(){if(!document.getElementById("test_ajax"))return;e();const o={csrf:Bee.csrf};try{const e=await fetch("ajax/test",{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify(o)}).then((e=>e.json())).catch((e=>{throw new Error(e)}));200===e.status?toastr.success(e.msg,"Prueba AJAX"):toastr.error(e.msg,"¡Error!")}catch(e){toastr.error(e,"¡Error!")}t()}();const o=document.getElementById("mainWrapperCotizacion"),n=document.getElementById("wrapperCotizacion"),r=o.dataset.id,a=new bootstrap.Modal("#clientInfoModal"),s=document.getElementById("clientInfoForm"),c=document.getElementById("clientInfoFormSubmit"),i=new bootstrap.Modal("#addConceptoModal"),l=document.getElementById("addConceptoForm"),d=document.getElementById("addConceptoFormSubmit"),m=new bootstrap.Modal("#editConceptoModal"),u=document.getElementById("editConceptoForm"),f=document.getElementById("editConceptoFormCancel"),p=document.getElementById("editConceptoFormSubmit"),h=document.getElementById("restartCotizacion"),g=document.getElementById("downloadCotizacion"),y=document.getElementById("sendCotizacion"),v=document.getElementById("completeCotizacion");async function w(){let o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;o&&o.preventDefault();const a={csrf:Bee.csrf,numero:r};e();const c=await fetch("ajax/cargar-cotizacion",{method:"post",body:JSON.stringify(a)}).then((e=>e.json())).catch((e=>toastr.error(c.msg)));if(t(),200!=c.status)return toastr.error(c.msg),void(n.innerHTML=c.msg);const{cotizacion:i,html:l}=c.data;n.innerHTML=l,s.elements.cliente.value=i.cliente,s.elements.empresa.value=i.empresa,s.elements.email.value=i.email;const d=document.querySelectorAll(".editConcepto"),f=document.querySelectorAll(".deleteConcepto");Array.from(d).forEach((e=>{const t=e.dataset.id;e.addEventListener("click",(async e=>{const o=await async function(e){return await fetch(`ajax/cargar-concepto/${e}`).then((e=>e.json())).catch((e=>toastr.error(e)))}(t);if(200!==o.status)return void toastr.error(o.msg);const n=o.data;u.elements.id.value=n.id,u.elements.concepto.value=n.concepto,u.elements.cantidad.value=n.cantidad,u.elements.precio.value=parseFloat(n.precio),Array.from(u.elements.tipo.options).forEach((e=>{e.value==n.tipo&&(e.selected=!0)})),m.show()}))})),Array.from(f).forEach((e=>{const t=e.dataset.id;e.addEventListener("click",(async e=>{if(0==(await Swal.fire({title:"¿Seguro quieres borrar el concepto?",showCancelButton:!0,confirmButtonText:"Borrar ahora"})).isConfirmed)return;const o={csrf:Bee.csrf,numero:r},n=await fetch(`ajax/borrar-concepto/${t}`,{method:"post",body:JSON.stringify(o)}).then((e=>e.json())).catch((e=>toastr.error(e)));200===n.status?(Swal.fire("Concepto borrado",n.msg,"success"),w()):toastr.error(n.msg)}))})),v.disabled="completed"===i.status}c.addEventListener("click",(async function(o){o.preventDefault();const n=s.elements.cliente,c=s.elements.empresa,i=s.elements.email;e();const l={csrf:Bee.csrf,cliente:n.value,empresa:c.value,email:i.value,numero:r},d=await fetch("ajax/agregar-cliente",{method:"post",body:JSON.stringify(l)}).then((e=>e.json())).catch((e=>toastr.error(e)));if(t(),200!==d.status)return toastr.error(d.msg),void n.focus();a.hide(),toastr.success(d.msg),w()})),d.addEventListener("click",(async function(o){o.preventDefault();const n=l.elements.concepto,a=l.elements.tipo,s=l.elements.cantidad,c=l.elements.precio;e();const d={csrf:Bee.csrf,numero:r,concepto:n.value,tipo:a.value,cantidad:s.value,precio:parseFloat(c.value)},m=await fetch("ajax/agregar-concepto",{method:"post",body:JSON.stringify(d)}).then((e=>e.json())).catch((e=>toastr.error(e)));if(t(),201!==m.status)return toastr.error(m.msg),void n.focus();toastr.success(m.msg),l.reset(),i.hide(),w()})),h.addEventListener("click",(async function(e){e.preventDefault();if(1!=(await Swal.fire({title:"¿Estás seguro?",showCancelButton:!0,confirmButtonText:"Reiniciar"})).isConfirmed)return;const t={csrf:Bee.csrf,numero:r},o=await fetch("ajax/reiniciar-cotizacion",{method:"post",body:JSON.stringify(t)}).then((e=>e.json())).catch((e=>toastr.error(e)));if(200!==o.status)return void toastr.error(o.msg);toastr.success(o.msg),w()})),f.addEventListener("click",(e=>{e.preventDefault(),u.reset(),m.hide()})),p.addEventListener("click",(async function(o){o.preventDefault();const n=u.elements.id,a=u.elements.concepto,s=u.elements.tipo,c=u.elements.cantidad,i=u.elements.precio;e();const l={csrf:Bee.csrf,numero:r,id:n.value,concepto:a.value,tipo:s.value,cantidad:c.value,precio:parseFloat(i.value)},d=await fetch("ajax/editar-concepto",{method:"post",body:JSON.stringify(l)}).then((e=>e.json())).catch((e=>toastr.error(e)));if(t(),200!==d.status)return toastr.error(d.msg),void a.focus();toastr.success(d.msg),u.reset(),m.hide(),w()})),v.addEventListener("click",(async function(e){e.preventDefault();if(1!=(await Swal.fire({title:"¿Estás seguro?",showCancelButton:!0,confirmButtonText:"Completar"})).isConfirmed)return;const t={csrf:Bee.csrf,numero:r},o=await fetch("ajax/completar",{method:"post",body:JSON.stringify(t)}).then((e=>e.json())).catch((e=>toastr.error(e)));if(200!==o.status)return void Swal.fire({title:"¡Error!",text:o.msg,icon:"error"});Swal.fire({title:"¡Listo!",text:o.msg,icon:"success"}),w()})),w(),g.addEventListener("click",(async e=>{e.preventDefault();const t={csrf:Bee.csrf,numero:r},o=await fetch("ajax/descargar-cotizacion",{method:"post",body:JSON.stringify(t)}).then((e=>e.json())).catch((e=>toastr.error(e)));200===o.status?(Swal.fire({title:"¡Excelente!",text:o.msg,icon:"success"}),setTimeout((()=>{const e=o.data;window.open(e,"_blank").focus()}),1500)):Swal.fire({title:"¡Error!",text:o.msg,icon:"error"})})),y.addEventListener("click",(async e=>{e.preventDefault();const t={csrf:Bee.csrf,numero:r},o=await fetch("ajax/enviar-cotizacion",{method:"post",body:JSON.stringify(t)}).then((e=>e.json())).catch((e=>toastr.error(e)));200===o.status?Swal.fire({title:"¡Excelente!",text:o.msg,icon:"success"}):Swal.fire({title:"¡Error!",text:o.msg,icon:"error"})}))}))}();
//# sourceMappingURL=main.min.js.map